<!DOCTYPE HTML>
<html>
    <head>
        <link rel="Stylesheet" type="text/css" href="/static/css/style.css">
        <link rel="Stylesheet" type="text/css" href="/static/css/tango.css">
        <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
        <link rel="icon" href="/favicon.ico" type="image/x-icon">
        <title>Caffe学习笔记1--Ubuntu 14.04 64bit caffe安装 - 老顽童的wiki</title>
        <meta name="keywords" content="wiki, python, machine learning"/>
        <meta name="description" content="wiki-zhb is a wiki for zhbzz2007."/>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body>
        <div id="container">
            
<div id="header">
  <div id="post-nav"><a href="/">Home</a>&nbsp;»&nbsp;<a href="/#Dev-Environment">Dev-Environment</a>&nbsp;»&nbsp;Caffe学习笔记1--Ubuntu 14.04 64bit caffe安装</div>
</div>
<div class="clearfix"></div>
<div id="title">Caffe学习笔记1--Ubuntu 14.04 64bit caffe安装</div>
  <div id="content">
  <p>本篇博客主要用于记录Ubuntu 14.04 64bit操作系统搭建caffe环境，目前针对的的是CPU版本；</p>
<p>1.安装依赖库</p>
<div class="hlcode"><pre><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">libprotobuf</span><span class="o">-</span><span class="n">dev</span> <span class="n">libleveldb</span><span class="o">-</span><span class="n">dev</span> <span class="n">libsnappy</span><span class="o">-</span><span class="n">dev</span> <span class="n">libopencv</span><span class="o">-</span><span class="n">dev</span> <span class="n">libhdf5</span><span class="o">-</span><span class="n">serial</span><span class="o">-</span><span class="n">dev</span> <span class="n">protobuf</span><span class="o">-</span><span class="n">compiler</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">install</span><span class="o">-</span><span class="n">recommends</span> <span class="n">libboost</span><span class="o">-</span><span class="n">all</span><span class="o">-</span><span class="n">dev</span>
</pre></div>


<p>CUDA：如果仅仅是cpu安装，忽略这一步；</p>
<p>BLAS：安装ATLAS</p>
<div class="hlcode"><pre><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">libatlas</span><span class="o">-</span><span class="n">base</span><span class="o">-</span><span class="n">dev</span>
</pre></div>


<p>Python：可选</p>
<p>2.安装python依赖的依赖库：</p>
<p>安装gfortran,后面编译过程中会用到</p>
<div class="hlcode"><pre><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">gfortran</span>
</pre></div>


<p>安装blas,Ubuntu下对应的是libopenblas，其它操作系统可能需要安装其它版本的blas——这是个OS相关的。</p>
<div class="hlcode"><pre><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">libopenblas</span><span class="o">-</span><span class="n">dev</span>
</pre></div>


<p>安装lapack，Ubuntu下对应的是liblapack-dev，和OS相关。</p>
<div class="hlcode"><pre><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">liblapack</span><span class="o">-</span><span class="n">dev</span>
</pre></div>


<p>安装atlas，Ubuntu下对应的是libatlas-base-dev，和OS相关。</p>
<div class="hlcode"><pre><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">libatlas</span><span class="o">-</span><span class="n">base</span><span class="o">-</span><span class="n">dev</span>
</pre></div>


<p>安装pip</p>
<div class="hlcode"><pre><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">python</span><span class="o">-</span><span class="n">pip</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">python</span><span class="o">-</span><span class="n">dev</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">python</span><span class="o">-</span><span class="n">nose</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">g</span><span class="o">++</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">git</span>
</pre></div>


<p>3.Ubuntu14.04安装相关依赖库</p>
<div class="hlcode"><pre><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">libgflags</span><span class="o">-</span><span class="n">dev</span> <span class="n">libgoogle</span><span class="o">-</span><span class="n">glog</span><span class="o">-</span><span class="n">dev</span> <span class="n">liblmdb</span><span class="o">-</span><span class="n">dev</span>
</pre></div>


<p>4.通过git，拉取源码</p>
<div class="hlcode"><pre><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="o">:</span><span class="c1">//github.com/BVLC/caffe.git</span>
</pre></div>


<p>5.安装python依赖</p>
<div class="hlcode"><pre><span class="n">cd</span> <span class="n">caffe</span><span class="o">/</span><span class="n">python</span>
<span class="k">for</span> <span class="n">req</span> <span class="n">in</span> <span class="err">$</span><span class="p">(</span><span class="n">cat</span> <span class="n">requirements</span><span class="p">.</span><span class="n">txt</span><span class="p">);</span> <span class="k">do</span> <span class="n">sudo</span> <span class="n">pip</span> <span class="n">install</span> <span class="err">$</span><span class="n">req</span><span class="p">;</span> <span class="n">done</span>
</pre></div>


<p>6.编辑caffe所需的Makefile文件</p>
<div class="hlcode"><pre><span class="n">cd</span> <span class="n">caffe</span>
<span class="n">cp</span> <span class="n">Makefile</span><span class="p">.</span><span class="n">config</span><span class="p">.</span><span class="n">example</span> <span class="n">Makefile</span><span class="p">.</span><span class="n">config</span>
<span class="n">vim</span> <span class="n">Makefile</span><span class="p">.</span><span class="n">config</span>
</pre></div>


<p>主要修改这两处</p>
<div class="hlcode"><pre><span class="cp">#去掉注释</span>
<span class="n">CPU_ONLY</span> <span class="o">:=</span> <span class="mi">1</span>

<span class="n">BLAS_INCLUDE</span> <span class="o">:=</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">include</span><span class="o">/</span><span class="n">atlas</span><span class="o">/</span>
</pre></div>


<p>7.编译caffe</p>
<div class="hlcode"><pre><span class="n">make</span> <span class="o">-</span><span class="n">j4</span>
</pre></div>


<p>测试编译结果：</p>
<div class="hlcode"><pre><span class="n">make</span> <span class="n">test</span>
<span class="n">make</span> <span class="n">runtest</span>
</pre></div>


<p>测试结果如下：</p>
<p><img alt="" src="http://i.imgur.com/oEwskUe.png" /></p>
<p>8.配置python</p>
<div class="hlcode"><pre><span class="cp"># 编译pycaffe</span>
<span class="n">make</span> <span class="n">pycaffe</span> <span class="o">-</span><span class="n">j4</span>
<span class="n">make</span> <span class="n">distribute</span>
</pre></div>


<p>进入python后，直接import caffe会失败，</p>
<p><img alt="" src="http://i.imgur.com/3NdsB5k.png" /></p>
<p>在.bashrc中配置，</p>
<div class="hlcode"><pre><span class="n">sudo</span> <span class="n">gedit</span> <span class="o">~/</span><span class="p">.</span><span class="n">bashrc</span>
<span class="cp"># 我的caffe/python目录 /home/zhb/Desktop/Work/caffe/python</span>
<span class="n">export</span> <span class="n">PYTHONPATH</span><span class="o">=</span><span class="err">$</span><span class="n">PYTHONPATH</span><span class="o">:/</span><span class="n">your</span><span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">caffe</span><span class="o">/</span><span class="n">python</span>
<span class="n">source</span> <span class="o">~/</span><span class="p">.</span><span class="n">bashrc</span>
</pre></div>


<p><img alt="" src="http://i.imgur.com/sG2jIcL.png" /></p>
<p>9.mnist数据测试</p>
<div class="hlcode"><pre><span class="n">cd</span> <span class="n">caffe</span>

<span class="cp">#下载mnist数据</span>
<span class="n">sh</span> <span class="n">data</span><span class="o">/</span><span class="n">mnist</span><span class="o">/</span><span class="n">get_mnist</span><span class="p">.</span><span class="n">sh</span>

<span class="n">sh</span> <span class="n">examples</span><span class="o">/</span><span class="n">mnist</span><span class="o">/</span><span class="n">create_mnist</span><span class="p">.</span><span class="n">sh</span>

<span class="cp"># 修改 solver_mode 为 CPU</span>
<span class="n">vim</span> <span class="n">examples</span><span class="o">/</span><span class="n">mnist</span><span class="o">/</span><span class="n">lenet_solver</span><span class="p">.</span><span class="n">prototxt</span>

<span class="p">.</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">mnist</span><span class="o">/</span><span class="n">train_lenet</span><span class="p">.</span><span class="n">sh</span>
</pre></div>


<p>执行结果如下:</p>
<p><img alt="" src="http://i.imgur.com/XRilUTR.png" /></p>
<p>10.参考链接</p>
<p><a href="http://caffe.berkeleyvision.org/install_apt.html">Ubuntu Installation</a></p>
<p><a href="https://www.zybuluo.com/hanxiaoyang/note/364737">linux(ubuntu)下的caffe编译安装</a></p>
<p><a href="http://www.cnblogs.com/anyview/p/5025704.html">Ubuntu-安装-theano+caffe-超详细教程</a></p>
<p><a href="http://www.cnblogs.com/platero/p/3993877.html">Caffe + Ubuntu 14.04 64bit + CUDA 6.5 配置说明</a></p>
<p><a href="http://blog.csdn.net/forest_world/article/details/51371560"> Caffe研究实践 一 ------环境搭建</a></p>
<p><a href="https://github.com/BVLC/caffe/issues/263">GIthub Issues 263</a></p>
</div>

        </div>
        <div id="footer">
            <span>
                Copyright © 2016 zhbzz2007.
                Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.
            </span>
        </div>
        
    </body>
</html>